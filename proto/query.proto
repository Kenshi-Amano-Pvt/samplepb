//
//  QueryService用のParam型とResult型を定義したprotoファイル
//

syntax = "proto3";

option go_package = "/pb";

// 既存定義のインポート
import "proto/error.proto";
import "proto/models.proto";

// google/protobufモジュールのデータ型をインポート
import "google/protobuf/empty.proto";
import "google/protobuf/timestamp.proto";

package proto;

//*****************************************
// 商品カテゴリ検索用param型とResult型の定義
//*****************************************
//  カテゴリ検索用Param型
message CategoryParam{
  string id = 1;
}
//  商品カテゴリ複数件を返すResult型
message CategoriesResult {
  repeated Category categories = 1;
  Error error = 2;
  google.protobuf.Timestamp timestamp = 3;
}
//  商品カテゴリ1件を返すResult型
message CategoryResult {
  // エラーか検索結果のいずれかを返す
  oneof result {
    Category category = 1;
    Error error = 2;
  }
  google.protobuf.Timestamp timestamp = 3;
}

//*****************************************
// 商品検索用param型とResult型の定義
//*****************************************
//  商品検索用Param型
message ProductParam {
  string id = 1;
  string keyword = 2;
}
//  商品複数件を返すResult型
message ProductsResult {
  repeated Product products = 1;
  Error error = 2;
  google.protobuf.Timestamp timestamp = 3;
}
//  商品1件を返すResult型
message ProductResult {
  // エラーか検索結果のいずれかを返す
  oneof result {
    Product product = 1;
    Error error = 2;
  }
  google.protobuf.Timestamp timestamp = 3;
}

//*****************************************
// 商品カテゴリと商品の問合せサービス型の定義
//*****************************************
//  商品カテゴリ問合せサービス型
service CategoryQuery {
  rpc List(google.protobuf.Empty) returns (CategoriesResult);
  rpc ById(CategoryParam) returns (CategoryResult);
}

//  商品問合せサービス型
service ProductQuery {
  rpc ListStream(google.protobuf.Empty) returns (stream Product);
  rpc List(google.protobuf.Empty) returns (ProductsResult);
  rpc ById(ProductParam) returns (ProductResult);
  rpc ByKeyword(ProductParam) returns (ProductsResult);
}
